{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Admin\\\\Desktop\\\\App-Shopping\\\\screens\\\\ConfirmScreen\\\\ConfirmScreen.jsx\";\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useIsFocused, useNavigation } from '@react-navigation/native';\nimport React, { useEffect, useLayoutEffect, useState } from 'react';\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport ProductConfirm from \"../../components/ProductConfirm/ProductConfirm\";\nimport { postOrder, resetCheckOrder } from \"../../store/slices/cartSlice\";\nimport styles from \"./ConfirmScreenStyle\";\nimport { Modal, Portal, Button, Provider } from 'react-native-paper';\nimport { getInfoUser } from \"../../store/slices/userSlice\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport axios from 'axios';\n\nvar ConfirmScreen = function ConfirmScreen() {\n  var listData = useSelector(function (state) {\n    return state.Cart.list;\n  });\n  var isLogin = useSelector(function (state) {\n    return state.User.isLogin;\n  });\n  var navigation = useNavigation();\n  var user = useSelector(function (state) {\n    return state.User.user;\n  });\n  var dispatch = useDispatch();\n  var isFocused = useIsFocused();\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      count = _useState2[0],\n      setCount = _useState2[1];\n\n  var checkOrder = useSelector(function (state) {\n    return state.Cart.checkOrder;\n  });\n  var DetailOrder = useSelector(function (state) {\n    return state.Cart.order;\n  });\n\n  var showModal = function showModal() {\n    return setVisible(true);\n  };\n\n  var hideModal = function hideModal() {\n    dispatch(resetCheckOrder());\n  };\n\n  useEffect(function () {\n    dispatch(getInfoUser());\n  }, []);\n  useEffect(function () {\n    var setHeader = function setHeader() {\n      var token;\n      return _regeneratorRuntime.async(function setHeader$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('token'));\n\n            case 2:\n              token = _context.sent;\n              axios.defaults.headers.common['Authorization'] = \"Bearer \" + token;\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    setHeader();\n  }, [navigation]);\n  useEffect(function () {\n    dispatch(resetCheckOrder());\n  }, []);\n  useLayoutEffect(function () {\n    setCount(function (count) {\n      return count + 1;\n    });\n\n    if (isFocused) {\n      if (!isLogin) {\n        if (count >= 3) {\n          navigation.navigate('HomeScreen');\n          navigation.pop();\n        } else {\n          navigation.navigate('LoginHomeScreen');\n        }\n      }\n    }\n  }, [isFocused]);\n\n  var postOrderFinish = function postOrderFinish() {\n    var newOrder = [];\n    listData.map(function (item) {\n      newOrder = [].concat(_toConsumableArray(newOrder), [{\n        product_id: item.id,\n        quantity: item.count\n      }]);\n    });\n    dispatch(postOrder(newOrder));\n  };\n\n  var renderListData = function renderListData() {\n    if (listData.length === 0) return React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 12\n      }\n    }, \"Gi\\u1ECF h\\xE0ng hi\\u1EC7n t\\u1EA1i ch\\u01B0a c\\xF3 s\\u1EA3n ph\\u1EA9m\");\n    return listData.map(function (item, index) {\n      return React.createElement(ProductConfirm, {\n        key: index,\n        id: item == null ? void 0 : item.id,\n        count: item == null ? void 0 : item.count,\n        image: item == null ? void 0 : item.image,\n        name: item == null ? void 0 : item.name,\n        price: item == null ? void 0 : item.price,\n        price_sale_off: item == null ? void 0 : item.price_sale_off,\n        rating: item == null ? void 0 : item.rating,\n        summary: item == null ? void 0 : item.summary,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 9\n        }\n      });\n    });\n  };\n\n  var ChangeScreen = function ChangeScreen(name) {\n    navigation.navigate(name);\n  };\n\n  return React.createElement(View, {\n    style: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 5\n    }\n  }, React.createElement(Portal, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }\n  }, React.createElement(Modal, {\n    visible: checkOrder,\n    onDismiss: hideModal,\n    contentContainerStyle: styles.modal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 8\n    }\n  }, React.createElement(Text, {\n    style: styles.titleModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, \"TH\\xD4NG B\\xC1O\"), React.createElement(View, {\n    style: styles.wrapImageModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 13\n    }\n  }, React.createElement(Image, {\n    style: styles.imageModal,\n    source: require(\"../../assets/images/checked.png\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 15\n    }\n  })), React.createElement(Text, {\n    style: styles.successModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }\n  }, \"\\u0110\\u1EB7t h\\xE0ng th\\xE0nh c\\xF4ng\"), React.createElement(View, {\n    style: styles.orderModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, React.createElement(Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 45\n    }\n  }, \"M\\xE3 s\\u1ED1 \\u0111\\u01A1n h\\xE0ng c\\u1EE7a b\\u1EA1n \"), React.createElement(Text, {\n    style: styles.idOrder,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 81\n    }\n  }, \"#\", DetailOrder == null ? void 0 : DetailOrder.id)), React.createElement(View, {\n    style: styles.wrapButtonModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return ChangeScreen('HomeMainScreen');\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 15\n    }\n  }, React.createElement(Text, {\n    style: styles.continueModal,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 15\n    }\n  }, \"Ti\\u1EBFp t\\u1EE5c mua h\\xE0ng\"))))), React.createElement(ScrollView, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }\n  }, renderListData(), React.createElement(View, {\n    style: styles.confirm,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.titleConfirm,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 11\n    }\n  }, \"X\\xE1c nh\\u1EADn th\\xF4ng tin\")), React.createElement(View, {\n    style: styles.address,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.itemAddress,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.addressName,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 15\n    }\n  }, user == null ? void 0 : user.name, \" - \", user == null ? void 0 : user.phone), React.createElement(Text, {\n    style: styles.addressContent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 15\n    }\n  }, user == null ? void 0 : user.address)))), React.createElement(View, {\n    style: styles.buttonBottom,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }\n  }, React.createElement(TouchableOpacity, {\n    onPress: postOrderFinish,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: styles.bottom,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 11\n    }\n  }, \"\\u0110\\u1EB7t h\\xE0ng\"))));\n};\n\nexport default ConfirmScreen;","map":{"version":3,"sources":["C:/Users/Admin/Desktop/App-Shopping/screens/ConfirmScreen/ConfirmScreen.jsx"],"names":["useIsFocused","useNavigation","React","useEffect","useLayoutEffect","useState","useDispatch","useSelector","ProductConfirm","postOrder","resetCheckOrder","styles","Modal","Portal","Button","Provider","getInfoUser","AsyncStorage","axios","ConfirmScreen","listData","state","Cart","list","isLogin","User","navigation","user","dispatch","isFocused","count","setCount","checkOrder","DetailOrder","order","showModal","setVisible","hideModal","setHeader","getItem","token","defaults","headers","common","navigate","pop","postOrderFinish","newOrder","map","item","product_id","id","quantity","renderListData","length","index","image","name","price","price_sale_off","rating","summary","ChangeScreen","container","modal","titleModal","wrapImageModal","imageModal","require","successModal","orderModal","idOrder","wrapButtonModal","continueModal","confirm","titleConfirm","address","itemAddress","addressName","phone","addressContent","buttonBottom","bottom"],"mappings":"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","sourcesContent":["import { useIsFocused, useNavigation } from '@react-navigation/native';\r\nimport React, { useEffect, useLayoutEffect, useState } from 'react';\r\nimport { Image, ScrollView, Text, TouchableOpacity, View } from 'react-native';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport ProductConfirm from '../../components/ProductConfirm/ProductConfirm';\r\nimport { postOrder, resetCheckOrder } from '../../store/slices/cartSlice';\r\nimport styles from './ConfirmScreenStyle';\r\nimport { Modal, Portal, Button, Provider } from 'react-native-paper';\r\nimport { getInfoUser } from '../../store/slices/userSlice';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport axios from 'axios';  \r\nconst ConfirmScreen = () => {\r\n  const listData = useSelector(state => state.Cart.list);\r\n  const isLogin = useSelector(state => state.User.isLogin)\r\n  const navigation = useNavigation();\r\n  const user = useSelector(state => state.User.user)\r\n  const dispatch = useDispatch();\r\n  const isFocused = useIsFocused();\r\n  const [count, setCount] = useState(0);\r\n  const checkOrder = useSelector(state => state.Cart.checkOrder);\r\n  const DetailOrder = useSelector(state => state.Cart.order);\r\n  // const [visible, setVisible] = useState(checkOrder);\r\n\r\n  const showModal = () => setVisible(true);\r\n  const hideModal = () => {\r\n    dispatch(resetCheckOrder())\r\n  }\r\n  useEffect(() => {\r\n    dispatch(getInfoUser());\r\n  },[])\r\n\r\n  useEffect(() => {\r\n    const setHeader = async () => {\r\n      let token = await AsyncStorage.getItem('token');\r\n      // console.log('axios', token)\r\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`\r\n    }\r\n    setHeader();\r\n  }, [navigation])\r\n\r\n\r\n  useEffect(() => {\r\n    dispatch(resetCheckOrder())\r\n  }, [])\r\n\r\n  useLayoutEffect(() => {\r\n    setCount(count => count + 1);\r\n    if(isFocused){\r\n      if(!isLogin) {\r\n        if(count >= 3) {\r\n          navigation.navigate('HomeScreen')\r\n          navigation.pop();\r\n        }\r\n        else {\r\n          navigation.navigate('LoginHomeScreen')\r\n        }\r\n      }\r\n    }\r\n  }, [isFocused])\r\n\r\n  const postOrderFinish = () => {\r\n    let newOrder = [];\r\n    listData.map(item => {\r\n      newOrder = [...newOrder, {\r\n        product_id: item.id,\r\n        quantity: item.count\r\n      }]\r\n    })\r\n    dispatch(postOrder(newOrder))\r\n  }\r\n\r\n\r\n  const renderListData = () => {\r\n    if(listData.length === 0)\r\n    return <Text>Giỏ hàng hiện tại chưa có sản phẩm</Text>\r\n\r\n    return listData.map((item, index) => {\r\n      return (\r\n        <ProductConfirm\r\n          key={index}\r\n          id={item?.id}\r\n          count={item?.count}\r\n          image={item?.image}\r\n          name={item?.name}\r\n          price={item?.price}\r\n          price_sale_off={item?.price_sale_off}\r\n          rating={item?.rating}\r\n          summary={item?.summary}\r\n        />\r\n      )\r\n    })\r\n  }\r\n\r\n  const ChangeScreen = (name) => {\r\n    navigation.navigate(name)\r\n  }\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Portal>\r\n       <Modal visible={checkOrder} onDismiss={hideModal} contentContainerStyle={styles.modal}>\r\n            <Text style={styles.titleModal}>THÔNG BÁO</Text>\r\n            <View style={styles.wrapImageModal}>\r\n              <Image style={styles.imageModal} source={require('../../assets/images/checked.png')} />\r\n            </View>\r\n            <Text style={styles.successModal}>Đặt hàng thành công</Text>\r\n            <View style={styles.orderModal}><Text>Mã số đơn hàng của bạn </Text><Text style={styles.idOrder}>#{DetailOrder?.id}</Text></View>\r\n            <View style={styles.wrapButtonModal}>\r\n              <TouchableOpacity onPress={() => ChangeScreen('HomeMainScreen')}>\r\n              <Text style={styles.continueModal}>Tiếp tục mua hàng</Text>\r\n\r\n              </TouchableOpacity>\r\n              {/* <TouchableOpacity onPress={() => ChangeScreen('OrderScreen')}>\r\n\r\n              <Text style={styles.detailModal}>Chi tiết đơn hàng</Text>\r\n              </TouchableOpacity> */}\r\n            </View>\r\n        </Modal>\r\n        \r\n      </Portal>\r\n\r\n      <ScrollView>\r\n      {renderListData()}\r\n\r\n      <View style={styles.confirm}>\r\n          <Text style={styles.titleConfirm}>Xác nhận thông tin</Text>\r\n      </View>\r\n\r\n      {/* <View style={styles.groupButtonConfirm}>\r\n        <Text style={styles.buttonConfirm}>Đăng nhập để tiếp tục</Text>\r\n      </View> */}\r\n\r\n      <View style={styles.address}>\r\n          <View style={styles.itemAddress}>\r\n              <Text style={styles.addressName}>{user?.name} - {user?.phone}</Text>\r\n              <Text style={styles.addressContent}>{user?.address}</Text>\r\n          </View>\r\n      </View>\r\n      {/* <Text style={styles.changeTitle}>Thay đổi địa chỉ</Text> */}\r\n      \r\n      </ScrollView>\r\n      <View style={styles.buttonBottom}>\r\n        <TouchableOpacity onPress={postOrderFinish}>\r\n          <Text style={styles.bottom}>Đặt hàng</Text>\r\n        </TouchableOpacity>\r\n      \r\n      </View>\r\n    </View>\r\n  )\r\n}\r\n\r\nexport default ConfirmScreen"]},"metadata":{},"sourceType":"module"}